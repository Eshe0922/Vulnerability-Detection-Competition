# æ¼æ´žæ£€æµ‹åŠç±»åž‹åˆ¤æ–­æ•°æ®é›†

## ðŸ”¥ èµ›é¢˜ä»»åŠ¡

éšç€è½¯ä»¶çš„è§„æ¨¡å’Œå¤æ‚æ€§çš„ä¸æ–­å¢žé•¿ï¼Œè½¯ä»¶æ¼æ´žå¯¹äºŽç³»ç»Ÿçš„å®‰å…¨é€ æˆé‡å¤§å¨èƒï¼Œä¹Ÿç»™ç¤¾ä¼šå’Œä¼ä¸šå¸¦æ¥äº†å·¨å¤§æŸå¤±ã€‚è‡ªåŠ¨åŒ–æ¼æ´žæ£€æµ‹æŠ€æœ¯æ—¨åœ¨é«˜æ•ˆè¯†åˆ«è½¯ä»¶ä»£ç ä¸­å­˜åœ¨çš„æ½œåœ¨å¨èƒï¼Œç›®å‰å·²ç»æœ‰å¾ˆå¤šç›¸å…³æŠ€æœ¯åœ¨è¯¥é¢†åŸŸæœ‰æ‰€è¿›å±•ã€‚åŸºäºŽç¨‹åºåˆ†æžçš„æ–¹æ³•ï¼Œå¦‚é™æ€åˆ†æžå’ŒåŠ¨æ€åˆ†æžï¼Œé€šè¿‡è¿½è¸ªè½¯ä»¶ä»£ç çš„æ•°æ®æµå’ŒæŽ§åˆ¶æµè¯†åˆ«æ¼æ´žã€‚åŸºäºŽæ·±åº¦å­¦ä¹ çš„æ–¹æ³•é€šè¿‡æ·±å±‚ç¥žç»ç½‘ç»œæ•æ‰æ¼æ´žæ¨¡å¼ã€‚æ­¤å¤–ï¼Œå¯¹äºŽæ£€æµ‹å‡ºæ¥çš„å­˜åœ¨æ¼æ´žçš„ä»£ç ç‰‡æ®µï¼Œæœ‰æ•ˆçš„æ¼æ´žæ£€æµ‹æŠ€æœ¯ä¹Ÿåº”å¯¹å…¶è¿›è¡Œæ¼æ´žç±»åž‹åˆ¤æ–­ï¼Œå³å¯¹åº”åˆ°CWEï¼ˆé€šç”¨ç¼ºé™·æžšä¸¾ï¼‰ä¸­çš„ç‰¹å®šç±»åˆ«ã€‚æœ¬èµ›é¢˜è¦æ±‚å‚èµ›é˜Ÿä¼è®¾è®¡ç®—æ³•ï¼Œå»ºç«‹æ¨¡åž‹ï¼Œå¯¹ç»™å®šçš„ä»£ç ç‰‡æ®µè¿›è¡Œæ¼æ´žæ£€æµ‹ï¼Œå¹¶è¿›è¡Œæ¼æ´žç±»åž‹çš„åˆ¤æ–­ã€‚

## ðŸ“¥ æ•°æ®é›†ä¸‹è½½

æ•°æ®é›†å·²åˆ’åˆ†ä¸ºè®­ç»ƒé›†ã€éªŒè¯é›†ã€æµ‹è¯•é›†ï¼Œå³`train.jsonl'ã€`valid.jsonl'å’Œ`test.jsonl'ï¼Œä¸‹è½½é“¾æŽ¥ä¸ºï¼š
```
https://drive.google.com/file/d/18pkURdURNzQItFy2DdA0b7lNhfGCnEdZ/view?usp=sharing
```

æ•°æ®é›†çš„æ¡ç›®æ€»æ•°å’Œæ¼æ´žæ¡ç›®æ•°ä¸ºï¼š
| æ•°æ®é›† | æ€»æ¡ç›® | æ¼æ´žæ¡ç›® |
|:---------|:--------:|:--------:|
| è®­ç»ƒé›† | 147,863 | 4,528|
| éªŒè¯é›† | 18,483 | 562 |
| æµ‹è¯•é›† | 18,483 | â€”â€” |

## ðŸ” æ•°æ®æ ¼å¼è¯´æ˜Ž

| å±žæ€§å | å±žæ€§å«ä¹‰ | å…¶ä»–è¯´æ˜Ž |
|:---------|:--------:|:--------|
| function_id | ä»£ç ç‰‡æ®µå”¯ä¸€ç¼–å· | æ—  |
| function | ä»£ç ç‰‡æ®µ | ä»£ç ç‰‡æ®µçš„ç²’åº¦ä¸ºå•ä¸ªå‡½æ•°ï¼ŒåŒ…æ‹¬å‡½æ•°åå’Œå‡½æ•°ä½“ |
| target | æ¼æ´žæ ‡ç­¾ï¼ˆ1ä¸ºæœ‰æ¼æ´žï¼Œ0ä¸ºæ²¡æœ‰æ¼æ´žï¼‰| æ—  |
| cve_id | æ¼æ´žç¼–å· | å®‰å…¨è¡¥ä¸å¯¹åº”ä¿®å¤çš„æ¼æ´žç¼–å·ï¼Œå½¢å¦‚"CVE-2022-1052" | 
| cve_description | æ¼æ´žæè¿° | æ­¤æ¼æ´žç¼–å·å¯¹åº”çš„æ¼æ´žæè¿° |
| cvss | æ¼æ´žä¸¥é‡ç­‰çº§è¯„åˆ† | 0-10åˆ†ï¼Œåˆ†æ•°è¶Šé«˜æ¼æ´žè¶Šä¸¥é‡ |
| cwe_id | æ¼æ´žç±»åž‹ç¼–å· | æ­¤æ¼æ´žç¼–å·æ‰€å¯¹åº”çš„æ¼æ´žç±»åž‹ï¼ˆå¯èƒ½æœ‰å¤šä¸ªç±»åž‹ï¼‰ï¼Œå¦‚è¶Šç•Œè¯»å†™ï¼Œç¼“å†²åŒºæº¢å‡ºï¼Œé™¤é›¶é”™è¯¯ç­‰ï¼Œå½¢å¦‚"CWE-787" |
| cwe_description | æ­¤ç±»åž‹æ¼æ´žï¼ˆcwe_idï¼‰å¯¹åº”çš„æè¿° | æ—  |
| cwe_consequence | æ­¤ç±»åž‹æ¼æ´žï¼ˆcwe_idï¼‰å¯èƒ½é€ æˆçš„å½±å“ | æ—  |
| cwe_solution | æ­¤ç±»æ¼æ´žï¼ˆcwe_idï¼‰å¯èƒ½çš„è§£å†³æ–¹æ³• | æ—  |
| commit_message | å®‰å…¨è¡¥ä¸æäº¤ä¿¡æ¯ | æ—  |
| commit_date | å®‰å…¨è¡¥ä¸æäº¤æ—¥æœŸ | æ—  |
| project | è¡¥ä¸æ‰€åœ¨é¡¹ç›®åç§° | å¦‚linux, gpac, vimç­‰ |

> æ•°æ®é›†åŸºäºŽå®‰å…¨è¡¥ä¸è¿›è¡Œçˆ¬å–ï¼Œæ¯ä¸ªå®‰å…¨è¡¥ä¸æœ‰å¯¹åº”çš„æ¼æ´žç¼–å·ï¼ˆæ­¤å®‰å…¨è¡¥ä¸ä¿®å¤çš„æ¼æ´žç¼–å·ï¼‰ï¼Œæ¯ä¸ªæ¼æ´žç¼–å·æœ‰å¯¹åº”çš„æ¼æ´žç±»åž‹ç¼–å·ï¼ˆå¯èƒ½æœ‰å¤šä¸ªï¼‰ï¼Œä»Žå®‰å…¨è¡¥ä¸ä¸­è¿›è¡Œåˆ’åˆ†å¾—åˆ°å‡½æ•°çº§åˆ«ç²’åº¦çš„ä»£ç ç‰‡æ®µ

> è®­ç»ƒé›†çš„æ•°æ®æ¡ç›®å¯èƒ½åŒ…å«å¤šä¸ªæ¼æ´žç±»åž‹ç¼–å·ï¼Œè€ŒéªŒè¯é›†å’Œæµ‹è¯•é›†çš„æ•°æ®æ¡ç›®ä»…åŒ…å«ä¸€ä¸ªæ¼æ´žç±»åž‹ç¼–å·

## ðŸ“ æ•°æ®æ ·ä¾‹
```
{
    "function_id": "0052500c1ed5bf8263b26b9fd7773dbdc6f170c4_31",
    "function": "struct MACH0_(obj_t) *MACH0_(new_buf)(RBuffer *buf, struct MACH0_(opts_t) *options) {\n\tr_return_val_if_fail (buf, NULL);\n\tstruct MACH0_(obj_t) *bin = R_NEW0 (struct MACH0_(obj_t));\n\tif (bin) {\n\t\tbin->b = r_buf_ref (buf);\n\t\tbin->main_addr = UT64_MAX;\n\t\tbin->kv = sdb_new (NULL, \"bin.mach0\", 0);\n\t\tbin->size = r_buf_size (bin->b);\n\t\tif (options) {\n\t\t\tbin->verbose = options->verbose;\n\t\t\tbin->header_at = options->header_at;\n\t\t\tbin->symbols_off = options->symbols_off;\n\t\t}\n\t\tif (!init (bin)) {\n\t\t\treturn MACH0_(mach0_free)(bin);\n\t\t}\n\t}\n\treturn bin;\n}",
    "target": 0,
    "cve_id": "CVE-2022-1052",
    "cve_description": "Heap Buffer Overflow in iterate_chained_fixups in GitHub repository radareorg/radare2 prior to 5.6.6.",
    "cvss": "7.8",
    "cwe_id": [
        "CWE-787",
        "CWE-125"
    ],
    "cwe_description": "The product reads data past the end, or before the beginning, of the intended buffer.",
    "cwe_consequence": "::SCOPE:Confidentiality:IMPACT:Read Memory::SCOPE:Confidentiality:IMPACT:Bypass Protection Mechanism:NOTE:By reading out-of-bounds memory, an attacker might be able to get secret values, such as memory addresses, which can be bypass protection mechanisms such as ASLR in order to improve the reliability and likelihood of exploiting a separate weakness to achieve code execution instead of just denial of service.::",
    "cwe_solution": "::PHASE:Implementation:STRATEGY:Input Validation:DESCRIPTION:Assume all input is malicious. Use an accept known good input validation strategy, i.e., use a list of acceptable inputs that strictly conform to specifications. Reject any input that does not strictly conform to specifications, or transform it into something that does. When performing input validation, consider all potentially relevant properties, including length, type of input, the full range of acceptable values, missing or extra inputs, syntax, consistency across related fields, and conformance to business rules. As an example of business rule logic, boat may be syntactically valid because it only contains alphanumeric characters, but it is not valid if the input is only expected to contain colors such as red or blue. Do not rely exclusively on looking for malicious or malformed inputs. This is likely to miss at least one undesirable input, especially if the code's environment changes. This can give attackers enough room to bypass the intended validation. However, denylists can be useful for detecting potential attacks or determining which inputs are so malformed that they should be rejected outright. To reduce the likelihood of introducing an out-of-bounds read, ensure that you validate and ensure correct calculations for any length argument, buffer size calculation, or offset. Be especially careful of relying on a sentinel (i.e. special character such as NUL) in untrusted inputs.::PHASE:Architecture and Design:STRATEGY:Language Selection:DESCRIPTION:Use a language that provides appropriate memory abstractions.::",
    "commit_message": "Fix heap OOB read in macho.iterate_chained_fixups ##crash\n\n* Reported by peacock-doris via huntr.dev\r\n* Reproducer 'tests_65305'\r\n\r\nmrmacete:\r\n* Return early if segs_count is 0\r\n* Initialize segs_count also for reconstructed fixups\r\n\r\nCo-authored-by: pancake <pancake@nopcode.org>\r\nCo-authored-by: Francesco Tamagni <mrmacete@protonmail.ch>",
    "commit_date": "2022-03-22T15:56:27Z",
    "project": "radareorg/radare2"
}
```

